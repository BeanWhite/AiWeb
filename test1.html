<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<script src="js/vue.js" type="text/javascript" charset="utf-8"></script>
		<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
		<script src="js/vue.min.js"></script>
	</head>
	<body>
		<button type="button" onclick="sendMSG()">ppp</button>
		
		<div id="b">
			{{message}}
			<input v-model="message" />
		</div>
	</body>
	<script>
		new Vue({
			el:'#a',
			data:{
				
			}
		})
		new Vue({
			el:'#b',
			data:{
				message:"fadsfdasf"
			}
		})
		var a = 0;
		var b = {
			k: "abc",
			m: "ppp"
		};
		console.log(typeof(WebSocket))
		var websocket = null;
		websocket = new WebSocket('ws://localhost:80/websocket')
		websocket.onopen = function(e) {
			console.log('建立连接', e.data)
		}

		websocket.onclose = function(e) {
			console.log('连接关闭', e.data)
		}

		websocket.onmessage = function(e) {
			console.log("有消息推送", e.data);
			console.log(typeof e.data);
			if (a >0)
				console.log(JSON.parse(e.data))
			a++;
			let k = e.data;
		}

		function sendMSG() {
			websocket.send(JSON.stringify(b));

		}

		websocket.onerror = function() {
			console.log('建立连接出错')
		}
		window.onbeforeunload = function() {
			websocket.close();
		}


		// var scale = {
		// 	scaleName:{
		// 		id:"量表id"
		// 		name:"量表名称"
		// 		question_content:"题目内容描述",
		// 		question_option:"答案选项",
		// 		question_rightAnswer:"正确答案",
		// 		question_img:"在描述题目中是否有无答案",
		// 		question_type:"需要答案/需要画图/只需观察"
		// 	}
		// }
	</script>
</html>
